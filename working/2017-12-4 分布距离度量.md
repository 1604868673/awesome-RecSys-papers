# 分布距离度量

总结+理解于知乎问题[分布的相似度（距离）用什么模型比较好？](https://www.zhihu.com/question/39872326?sort=created) 

## KL

KL全称[Kullback-Leibler divergence](https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Kullback%25E2%2580%2593Leibler_divergence) ，分布$p(x)$ 和$q(x)$ 之间的KL散度定义为
$$
D_{\text{KL}}(p\|q)=\int_xp(x)\ln\frac{p(x)}{q(x)}dx
$$
由上式可得$D_{\text{KL}}\in[0,+\infty]$ KL对应两个相似的分布可以较好的度量，但如果两个人分布不太一致，就会出现一些问题，由上式我们可以看出，如果要求KL小，从$p(x)$ 的角度讲，会在$p(x)$ 小的时候，KL对此时的差距不敏感，比如说，当$p(x)$ 与$q(x)$ 的一部分完全相同，但是在$q(x)$ 的其余部分，与$p(x)$ 差异很大，但这部分所应的$p(x)$ 却十分小，$\ln\frac{p(x)}{q(x)}$ 很大却因为$p(x)$ 特别小，所以对最后积分后的KL影响也会很小。同时，我们也注意到，KL散度是不具有对称性的，即
$$
D_{\text{KL}}(p\|q)\neq D_{\text{KL}}(q\|p)
$$
同时KL散度并没有平移相似的性质，两个完全的分布$p(x)$ 和$q(x)$ ，但只有其中一个分布平移一下，两个分布的KL散度就会相差很大，这是因为KL散度对比的是在同一位置进行的。

## JS散度

JS散度是之前提到的GAN中的一种度量方式，主要建立与KL散度之上：
$$
JS(P_1\|P_2)=\frac{1}{2}KL(P_1\|\frac{P_1+P_2}{2})+\frac{1}{2}KL(P_2\|\frac{P_1+P_2}{2})
$$

## f-divergence

KL散度就属于一种特殊的f-divergence，f-divergence如下
$$
D_{f}(p\|q)=\int_xq(x)f(\frac{p(x)}{q(x)})dx
$$
当$f=-\log t$ 时，f-divergence就成为KL散度。

## Wasserstein distance 

Wasserstein distance是最近比较火的一种度量方式，又称为Earth-Mover距离，用于衡量两个分布之间的距离，
$$
W(P_1,P_2)=\inf_{\gamma\sim\prod(P_1,P2)}\mathbb{E}_{(x,y)\sim\gamma}[\|x-y\|]
$$
其中$\prod(P_1,P_2)$ 表示两个分布组合起来的联合分布概率，也就是从两个分布的联合分布中抽取的样本$(x,y)$ 的距离期望。直观上可以理解为在$\gamma$ 这种路径上，把土堆$P_1$ 移动到$P_2$ 的消耗，所以也叫Earth-Mover距离。